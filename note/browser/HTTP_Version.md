# HTTP 版本对比
## HTTP 1.0

相比HTTP 0.9的变化：
- 请求方式新增了POST，DELETE，PUT，HEADER等方式
- 增添了请求头和响应头的概念，在通信中指定了 HTTP 协议版本号，以及其他的一些元信息 (比如: 状态码、权限、缓存、内容编码)
- 扩充了传输内容格式，具备了传输除纯文本HTML文件以外其他类型文档的能力，图片、音视频资源、二进制等都可以进行传输

请求头示例：
```http
GET / HTTP/1.0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5)
Accept: */*
```

响应头示例：
```http
HTTP/1.0 200 OK
Content-Type: text/plain
Content-Length: 137582
Expires: Thu, 05 Dec 1997 16:00:00 GMT
Last-Modified: Wed, 5 August 1996 15:55:28 GMT
// 这是一个空行
...数据内容
```

关于 `Content-Type`: 客户端依照这个字段解析响应内容，数据类型总称为MIME type，每个值包括一级类型和二级类型，之间用斜杠分隔。举例如下：
```http
text/plain
text/html
text/css

image/jpeg
image/png
image/svg+xml

audio/mp4
video/mp4

application/javascript
```

### 特性
- 无状态：服务器不跟踪不记录请求过的状态
  - 可以借助cookie/session机制来做身份认证和状态记录

- 无连接：浏览器每次请求都需要建立tcp连接
  - 无法复用连接，每次都需要进行三步握手四步释放，效率低
  - 队头阻塞，HTTP 1.0 规定在前一个请求响应到达之后下一个请求才能发送，如果前一个阻塞，后面的请求也给阻塞的

## HTTP 1.1
### 特性
- 长连接：新增 `Connection` 字段，可以设置 `keep-alive` 值保持连接不断开
  - HTTP 1.1默认保持长连接，数据传输完成保持tcp连接不断开,继续用这个通道传输数据

- 管道化：基于上面长连接的基础，管道化可以不等第一个请求响应继续发送后面的请求，但响应的顺序还是按照请求的顺序返回
  - 可以一次发送多个请求，但是响应仍是顺序返回，仍然无法解决队头阻塞的问题

- 缓存处理：新增字段 Cache-Control
  - 参见 [HTTP缓存](HTTP_Cache.md)

- 断点传输
  - 在上传/下载资源时，如果资源过大，将其分割为多个部分，分别上传/下载，如果遇到网络故障，可以从已经上传/下载好的地方继续请求，不用从头开始，提高效率

## HTTP 2.0
### 特性
- 二进制分帧:
  - HTTP 2之后将所有传输的信息分割为更小的消息和帧，并对它们采用二进制格式的编码，提高传输效率

- 多路复用： 在共享TCP链接的基础上同时发送请求和响应
  - 在同一域名下所有访问都是从同一个tcp连接中走，http消息被分解为独立的帧，乱序发送，服务端根据标识符和首部将消息重新组装起来。

- 头部压缩:
  - > 由于 HTTP 是无状态的，每一个请求都需要头部信息标识这次请求相关信息，所以会造成传输很多重复的信息，当请求数量增大的时候，消耗的资源就会慢慢积累上去。
  - HTTP 2 维护一个头部信息字典，差量进行更新头信息，减少头部信息传输占用的资源

- 服务器推送：服务器可以额外的向客户端推送资源，而无需客户端明确的请求
  - 常见场景是客户端请求一个网页，这个网页里面包含很多静态资源。正常情况下，客户端必须收到网页后，解析HTML源码，发现有静态资源，再发出静态资源请求。其实，服务器可以预期到客户端请求网页后，很可能会再请求静态资源，所以就主动把这些静态资源随着网页一起发给客户端了。
